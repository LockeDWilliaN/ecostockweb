{%extends "base.html"%}

{%block title%} Home {% endblock %}

{% load static %}

{% block content %}
{% if user.is_authenticated%}
<script>

  document.addEventListener("DOMContentLoaded", function(){
    const button = document.querySelector("#addbutton")
    const modal = document.querySelector("#addModal")

    button.onclick = function (){
      modal.showModal()
    }
  })

  document.addEventListener("DOMContentLoaded", function(){
    const button = document.querySelector("#remvbutton")
    const modal = document.querySelector("#removeModal")

    button.onclick = function (){
      modal.showModal()
    }
  })

  document.addEventListener("DOMContentLoaded", function() {
    const removeButton = document.querySelector("#remove-button");
    const removeForm = document.querySelector("#remove-form");

    removeButton.addEventListener("click", function() {
        removeForm.submit();
    });
  });

</script>

<link rel="stylesheet" type="text/css" href="{%static 'style.css'%}">
<nav class="navbar navbar-expand-lg bg-dark" data-bs-theme="dark">
    <div class="container-fluid">
      <a class="navbar-brand" href=>EcoStock</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarColor02">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="#">Sobre</a>
        </ul>
        <form class="d-flex" action="{% url 'logout'%}" method="post">
           {% csrf_token %}
           <button type="submit" class="btn btn-dark">Sair</button>
        </form>
      </div>
    </div>
  </nav>

<div class="container">
  <div class="row">
    <div class="col p-0">
      <div class="card">
          <div class="card-body">
              <div class="row g-2 align-items-center">
                  <div class="col-auto">
                      <select class="form-select" id="exampleSelect1">
                          <option>C√≥digo</option>
                          <option>Nome</option>
                          <option>Quantidade</option>
                          <option>Valor</option>
                      </select>
                  </div>
                  <div class="col">
                    <form method="get">
                      <input type="text" class="form-control">
                    </form>
                  </div>
                  <div class="col-auto">
                    <button type="submit" class="btn btn-outline-secondary">üîç</button>
                  </div>
                  <div class="col">
                    <div class="row">
                        <div class="col">
                          <button type="button" class="btn btn-success" id="addbutton">Adicionar</button>
                            <dialog id="addModal">
                              <div class="modal-dialog" role="document">
                                <div class="modal-content">  
                                  <div class="modal-header" style="justify-content: center;">
                                    <h3 class="modal-title">Adicionar Produto</h3>
                                  </div>
                                  <form method="POST" action="/home/" class="modal-body" style="display: flex; justify-content: center;">
                                    {% csrf_token %}
                                    <div class="form-group">
                                      <div style="margin: 20px;">
                                        <h4 style="text-align: center;">
                                          <label for="codigo">Preencha</label>
                                        </h4>
                                        <br>
                                        {{form.as_p}}
                                      </div>
                                      <div class="modal-footer" style="justify-content: space-between; margin-top: 5px;">
                                        <button name ="additem" type="submit" class="btn btn-outline-success" style="margin-left: 40px;">Adicionar</button>
                                        <button type="button" class="btn btn-outline-danger " style="margin-right: 40px;" data-bs-dismiss="modal" onclick="addModal.close()">Fechar</button>
                                      </div>
                                    </div>
                                  </form>
                                </div>
                              </div>
                            </dialog>
                          <button id="remvbutton"type="button" class="btn btn-danger">Remover</button>
                            <dialog id="removeModal">
                              <div class="modal-dialog" role="document">
                                <div class="modal-content">  
                                  <div class="modal-header" style="justify-content: center;">
                                    <h3 class="modal-title">Remover</h3>
                                  </div>
                                    <div class="form-group">
                                      <div style="margin: 20px;">
                                        <br>
                                        <h4 style="text-align: center;">Ap√≥s remover n√£o √© poss√≠vel restaurar.</h4>
                                        <br>
                                        <h4 style="text-align: center;">Voc√™ tem certeza?</h4>
                                        <br>                                          
                                      </div>
                                      <div class="modal-footer" style="justify-content: space-between; margin-top: 5px;">
                                    </div>
                                    <button type="button" class="btn btn-danger" id="remove-button">Remover</button>
                                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="removeModal.close()">Fechar</button>      
                                  </form>
                                </div>
                              </div>
                            </dialog>
                          <button type="button" class="btn btn-info">Editar</button>
                        </div>
                    </div>
                </div>
              </div>
          </div>
      </div>
  </div>
  <form method="post" id="remove-form">
    {% csrf_token %}
    <table class="table table-hover">
        <thead>
            <tr class="table-active">
                <th scope="col"> C√≥digo </th>
                <th scope="col"> Nome </th>
                <th scope="col"> Quantidade </th>
                <th scope="col"> Valor </th>
                <th scope="col"> Selecionar </th>
            </tr>
        </thead>
        <tbody>
            {% for produto in produtos %}
            <tr class="table-secondary">
                <th scope="row">{{produto.codigo}}</th>
                <td>{{produto.nome}}</td>
                <td>{{produto.quantidade}}</td>
                <td>R${{produto.valor}}</td>
                <td><input type="checkbox" name="produtos_selecionados" value="{{ produto.id }}"></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <input type="hidden" name="action" id="action" value="">
</form>

    </div>
    <div>
    </div>
    <div class="pagination-bar">
        <ul class="pagination">
            <li class="page-item disabled">
                <a class="page-link" href="#">&laquo;</a>
            </li>
            <li class="page-item active">
                <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">3</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">4</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">5</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">&raquo;</a>
            </li>
            </ul>
    </div>
</div>

{% else %}

<meta http-equiv="Refresh" content="0; url='/welcome/'" />

{% endif %}

{% endblock %}